-- Instances

local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local Upper = Instance.new("Frame")
local TextLabel = Instance.new("TextLabel")
local Down = Instance.new("Frame")
local ScrollingFrame = Instance.new("ScrollingFrame")
local LineNumbers = Instance.new("TextLabel")
local TextBox = Instance.new("TextBox")
local ExecuteButton = Instance.new("TextButton")
local ClearButton = Instance.new("TextButton")
local CopyButton = Instance.new("TextButton")

-- Properties

ScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(39, 39, 39)
MainFrame.BorderSizePixel = 0
MainFrame.Position = UDim2.new(0.1, 0, 0.2, 0)
MainFrame.Size = UDim2.new(0, 400, 0, 300)
MainFrame.Active = true

Upper.Name = "Upper"
Upper.Parent = MainFrame
Upper.BackgroundColor3 = Color3.fromRGB(107, 107, 107)
Upper.BorderSizePixel = 0
Upper.Size = UDim2.new(0, 400, 0, 20)

TextLabel.Parent = Upper
TextLabel.BackgroundColor3 = Color3.new(1, 1, 1)
TextLabel.BorderSizePixel = 0
TextLabel.Size = UDim2.new(0, 60, 0, 20)
TextLabel.Font = Enum.Font.SourceSans
TextLabel.Text = "Editor"
TextLabel.TextColor3 = Color3.new(0, 0, 0)
TextLabel.TextScaled = true
TextLabel.TextSize = 20
TextLabel.TextWrapped = true
TextLabel.TextXAlignment = Enum.TextXAlignment.Left
TextLabel.TextYAlignment = Enum.TextYAlignment.Top

Down.Name = "Down"
Down.Parent = MainFrame
Down.BackgroundColor3 = Color3.fromRGB(107, 107, 107)
Down.Position = UDim2.new(0, 0, 0.9, 0)
Down.Size = UDim2.new(0, 400, 0, 30)

ScrollingFrame.Parent = MainFrame
ScrollingFrame.BackgroundColor3 = Color3.fromRGB(200, 200, 200)
ScrollingFrame.BorderSizePixel = 0
ScrollingFrame.Position = UDim2.new(0, 0, 0.067, 0)
ScrollingFrame.Size = UDim2.new(0, 400, 0, 240)
ScrollingFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
ScrollingFrame.ScrollBarThickness = 6

LineNumbers.Name = "LineNumbers"
LineNumbers.Parent = ScrollingFrame
LineNumbers.BackgroundColor3 = Color3.fromRGB(169, 169, 169)
LineNumbers.BorderSizePixel = 0
LineNumbers.Size = UDim2.new(0, 25, 1, 0)
LineNumbers.Font = Enum.Font.SourceSans
LineNumbers.Text = "1"
LineNumbers.TextColor3 = Color3.new(0, 0, 0)
LineNumbers.TextSize = 12
LineNumbers.TextXAlignment = Enum.TextXAlignment.Right
LineNumbers.TextYAlignment = Enum.TextYAlignment.Top

TextBox.Parent = ScrollingFrame
TextBox.BackgroundColor3 = Color3.fromRGB(230, 230, 230)
TextBox.BorderSizePixel = 0
TextBox.Position = UDim2.new(0, 30, 0, 0)
TextBox.Size = UDim2.new(1, -35, 1, 0)
TextBox.Font = Enum.Font.SourceSans
TextBox.Text = "-- print(\"hello world\")"
TextBox.TextColor3 = Color3.new(0, 0, 0)
TextBox.TextSize = 12
TextBox.TextWrapped = false
TextBox.TextXAlignment = Enum.TextXAlignment.Left
TextBox.TextYAlignment = Enum.TextYAlignment.Top
TextBox.ClearTextOnFocus = false
TextBox.MultiLine = true

ExecuteButton.Parent = Down
ExecuteButton.BackgroundColor3 = Color3.fromRGB(107, 107, 107)
ExecuteButton.Size = UDim2.new(0, 80, 0, 25)
ExecuteButton.Font = Enum.Font.SourceSans
ExecuteButton.Text = "Execute"
ExecuteButton.TextColor3 = Color3.new(1, 1, 1)
ExecuteButton.TextSize = 14

ClearButton.Parent = Down
ClearButton.BackgroundColor3 = Color3.fromRGB(107, 107, 107)
ClearButton.Position = UDim2.new(0.25, 0, 0, 0)
ClearButton.Size = UDim2.new(0, 80, 0, 25)
ClearButton.Font = Enum.Font.SourceSans
ClearButton.Text = "Clear"
ClearButton.TextColor3 = Color3.new(1, 1, 1)
ClearButton.TextSize = 14

CopyButton.Parent = Down
CopyButton.BackgroundColor3 = Color3.fromRGB(107, 107, 107)
CopyButton.Position = UDim2.new(0.5, 0, 0, 0)
CopyButton.Size = UDim2.new(0, 80, 0, 25)
CopyButton.Font = Enum.Font.SourceSans
CopyButton.Text = "Copy"
CopyButton.TextColor3 = Color3.new(1, 1, 1)
CopyButton.TextSize = 14

-- Functions

local function updateLineNumbers()
    local lines = string.split(TextBox.Text, "\n")
    LineNumbers.Text = ""
    for i = 1, #lines do
        LineNumbers.Text = LineNumbers.Text .. tostring(i) .. "\n"
    end
    ScrollingFrame.CanvasSize = UDim2.new(0, 0, 0, #lines * 18) -- Update canvas size
end

TextBox:GetPropertyChangedSignal("Text"):Connect(function()
    updateLineNumbers()
end)

ScrollingFrame:GetPropertyChangedSignal("CanvasPosition"):Connect(function()
    LineNumbers.Position = UDim2.new(0, 0, 0, -ScrollingFrame.CanvasPosition.Y)
end)

ClearButton.MouseButton1Click:Connect(function()
    TextBox.Text = ""
    updateLineNumbers()
end)

CopyButton.MouseButton1Click:Connect(function()
    setclipboard(TextBox.Text)
end)

ExecuteButton.MouseButton1Click:Connect(function()
    loadstring(TextBox.Text)()
end)

local dragToggle, dragStart, dragPos
Upper.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragToggle = true
        dragStart = input.Position
        dragPos = MainFrame.Position
    end
end)

Upper.InputChanged:Connect(function(input)
    if dragToggle and input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(dragPos.X.Scale, dragPos.X.Offset + delta.X, dragPos.Y.Scale, dragPos.Y.Offset + delta.Y)
    end
end)

Upper.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragToggle = false
    end
end)

-- Initial Line Numbers
updateLineNumbers()
